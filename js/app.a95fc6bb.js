(function(e){function t(t){for(var r,i,o=t[0],c=t[1],u=t[2],f=0,d=[];f<o.length;f++)i=o[f],s[i]&&d.push(s[i][0]),s[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},s={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/serverless-example/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"213d":function(e,t,n){"use strict";var r=n("2d5c"),s=n.n(r);s.a},"2d5c":function(e,t,n){},4601:function(e,t,n){},"4c48":function(e,t,n){},"4ffd":function(e,t,n){e.exports=n.p+"img/logo.6a9d6678.png"},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var r=n("2b0e"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("nav",[r("router-link",{attrs:{to:"/"}},[r("img",{attrs:{src:n("4ffd")}})])],1),r("router-view")],1)},a=[],i=(n("5c0b"),n("2877")),o={},c=Object(i["a"])(o,s,a,!1,null,null,null);c.options.__file="App.vue";var u=c.exports,l=n("8c4f"),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home center"},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}]},[r("button",{staticClass:"btn-done",on:{click:e.electionDone}},[e._v("Election Done")]),r("router-link",{attrs:{to:"/raffle"}},[e._v("Raffle")])],1),e.user?r("section",[r("img",{staticClass:"img-user",attrs:{src:e.user.imgUrl}})]):r("section",[r("h1",[e._v("Please Identify")]),r("router-link",{staticClass:"btn-register",attrs:{to:"/register"}},[e._v("Identify")])],1),r("section",{class:{muted:!e.user}},[r("h1",[e._v("Who will guide Eurovision 2019?")]),r("div",{staticClass:"candidates",class:{disabled:!e.user,voted:e.voted}},[r("section",{on:{click:function(t){e.vote("Asi & Rotem")}}},[r("img",{attrs:{src:n("dace")}}),r("h3",[e._v("Asi & Rotem")])]),r("section",{on:{click:function(t){e.vote("Erez & Bar")}}},[r("img",{attrs:{src:n("fd04")}}),r("h3",[e._v("Erez & Bar")])])])]),e.user&&e.user.voteForCandidate?r("section",{staticClass:"vote-results"},[r("h1",[e._v("Election Results")]),r("bar-chart",{attrs:{"chart-data":e.candidates}}),r("hr"),r("div",[r("h2",[e._v("Best Voter:")]),r("img",{staticClass:"img-most-voter",attrs:{src:e.mostVoter.imgUrl}}),r("div",[e._v(e._s(e.mostVoter.name)+" voted "+e._s(e.mostVoter.votes)+" times")])]),r("ul",e._l(e.votersWithImg,function(e){return r("li",{key:e,staticClass:"voter"},[r("img",{staticClass:"img-voter",attrs:{src:e.imgUrl}})])}),0),r("div",[r("button",{staticClass:"btn-show",on:{click:function(t){e.shouldShowVoters=!e.shouldShowVoters}}},[e._v("Show all Voters")])]),e.shouldShowVoters?r("ol",e._l(e.votes,function(t){return r("li",{key:t.id},[r("span",[e._v(e._s(t.name))]),e._v("\n        for\n        "),r("span",[e._v(e._s(t.voteForCandidate))])])}),0):e._e()],1):e._e()])},d=[],p=n("db0c"),v=n.n(p),m=n("a4bb"),h=n.n(m),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"bar-chart"},e._l(e.chartData,function(t,r){return n("div",{key:t.name},[n("div",[e._v(e._s(t.name)+": "+e._s(t.value))]),n("Bar",{attrs:{color:e.colors[r],value:t.value}})],1)}),0)},b=[],_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("div",{staticClass:"bar",style:e.barStyles})])},C=[],w=(n("c5f6"),{name:"Bar",props:{value:{type:Number,required:!0},color:{type:String,required:!0}},computed:{barStyles:function(){return{width:"".concat(this.value,"%"),backgroundColor:this.color}}}}),y=w,k=(n("a93e"),Object(i["a"])(y,_,C,!1,null,"57e87cf9",null));k.options.__file="Bar.vue";var x=k.exports,V={name:"PieChart",components:{Bar:x},props:{chartData:{type:Array,required:!0}},data:function(){return{colors:["#c60000","#0e62ea","gold"]}}},O=V,j=Object(i["a"])(O,g,b,!1,null,null,null);j.options.__file="BarChart.vue";var R=j.exports,$=n("795b"),N=n.n($),P=n("f499"),U=n.n(P),D=n("5176"),E=n.n(D),S=n("59ca"),A=n.n(S),F=(n("66ce"),"https://us-central1-serverless-example-952af.cloudfunctions.net/notifySubscriptions"),I={apiKey:"AIzaSyAUWmOY_UshzqRNvWErwvHJ5xUear9CrRU",authDomain:"serverless-example-952af.firebaseapp.com",databaseURL:"https://serverless-example-952af.firebaseio.com",projectId:"serverless-example-952af",storageBucket:"serverless-example-952af.appspot.com",messagingSenderId:"680067478208"};A.a.initializeApp(I);var B=A.a.database(),M=function(e,t){return E()({},t,{id:e})},q=function(e){if(e)return h()(e).map(function(t){return M(t,e[t])})},L=function(e,t){B.ref(e).on("value",function(e){var n=q(e.val());t(n)})},T=function(e,t){return B.ref(e).push(t)},z=function(){return fetch(F,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:U()({})}).then(function(e){return e.json()}).then(function(e){return console.log("Done with fBase function",e)}).catch(function(e){return console.log("err",e),N.a.reject(error)})},K={subscribe:L,add:T,sendPush:z},W={name:"home",data:function(){return{shouldShowVoters:!1}},components:{BarChart:R},computed:{user:function(){return this.$store.state.user},voted:function(){return this.$store.state.user&&this.$store.state.user.voteForCandidate},isAdmin:function(){return this.$store.getters.isAdmin},votes:function(){return this.$store.getters.votes},candidates:function(){var e=this.$store.getters.candidates;return h()(e).map(function(t){return{name:t,value:e[t]}})},mostVoter:function(){var e=this.$store.getters.voters,t=h()(e).reduce(function(t,n){return e[t].votesCount>e[n].votesCount?t:n});return{name:t,votes:e[t].votesCount,imgUrl:e[t].imgUrl}},votersWithImg:function(){var e=this.$store.getters.voters;return v()(e).filter(function(e){return e.imgUrl})}},methods:{vote:function(e){this.user&&this.$store.dispatch({type:"vote",candidate:e})},electionDone:function(){K.sendPush()}}},Y=W,H=Object(i["a"])(Y,f,d,!1,null,"1ae57e05",null);H.options.__file="Home.vue";var J=H.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"register-container"},[n("div",{staticClass:"register-title"},[e._v("register")]),n("form",{staticClass:"form-register",on:{submit:function(t){return t.preventDefault(),e.register(t)}}},[n("div",{staticClass:"capture-container",class:{show:e.isCameraVisible}},[e.isCameraVisible?n("photo-capture",{on:{done:e.capturePhoto}}):e._e()],1),n("div",{staticClass:"img-container"},[n("div",{staticClass:"img-preview",style:{"background-image":"url("+e.imgData+")"},on:{click:e.showCamera}},[e.isProcessing?n("i",{staticClass:"fas fa-check btn-set-photo"}):n("i",{staticClass:"fas fa-camera btn-set-photo"}),e.isProcessing?n("div",{staticClass:"background verify-image"}):e._e()])]),n("div",{staticClass:"field"},[e._m(0),n("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],staticClass:"field-input",attrs:{type:"text",placeholder:"Name *"},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}})]),n("div",{staticClass:"field"},[e._m(1),n("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],staticClass:"field-input",attrs:{type:"email",placeholder:"Email *"},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}})]),n("div",{staticClass:"footer"},[n("button",{staticClass:"btn-identify",attrs:{disabled:!e.isValid&&e.isProcessing,type:"submit"}},[e._v("Verify Identity")])])])])},Z=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:"field-icon"},[n("i",{staticClass:"fas fa-user"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:"field-icon"},[n("i",{staticClass:"fas fa-envelope"})])}],G=(n("96cf"),n("3b8d")),Q=(n("7f7f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.enableCamera,expression:"enableCamera"}],staticClass:"photo-capture"},[e.pickImage?n("div",[n("h2",[e._v("Upload a clear Photo")]),n("input",{attrs:{type:"file",accept:"image/*",id:"image-picker"},on:{change:e.upload}}),n("div",{staticClass:"upload-actions"},[n("button",{staticClass:"btn-capture",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.done(t)}}},[n("i",{staticClass:"fas fa-thumbs-up"})])])]):n("div",{staticClass:"video-container"},[n("video",{directives:[{name:"show",rawName:"v-show",value:e.showVideo,expression:"showVideo"}],ref:"player",staticClass:"camera",attrs:{autoplay:"",playsinline:""}}),n("canvas",{directives:[{name:"show",rawName:"v-show",value:!e.showVideo,expression:"!showVideo"}],ref:"canvas",staticClass:"preview"}),n("div",{staticClass:"center photo-capture-actions"},[e.showVideo?n("button",{staticClass:"btn-capture",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.capture(t)}}},[n("i",{staticClass:"fas fa-camera"})]):n("div",[n("button",{staticClass:"btn-capture",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.cancel(t)}}},[n("i",{staticClass:"fas fa-undo-alt"})]),n("button",{staticClass:"btn-capture",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.done(t)}}},[n("i",{staticClass:"fas fa-thumbs-up"})])])])])])}),ee=[],te=(n("ac6a"),{ON_DONE:"done",ON_CLEAR:"clear"}),ne={props:{enableCamera:{type:Boolean,default:!0}},data:function(){return{showVideo:!0,pickImage:!1,picture:null}},mounted:function(){this.videoPlayer=this.$refs.player,this.canvasElement=this.$refs.canvas,this.streamUserMediaVideo()},computed:{},methods:{streamUserMediaVideo:function(){var e=this;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){return e.$refs.player.srcObject=t}).catch(function(t){e.pickImage=!0,console.error("could not open the camera",t)}):this.pickImage=!0},capture:function(){this.showVideo=!1,this.canvasElement.width=this.videoPlayer.videoWidth,this.canvasElement.height=this.videoPlayer.videoHeight;var e=this.canvasElement.getContext("2d");e.translate(this.canvasElement.width,0),e.scale(-1,1),e.drawImage(this.$refs.player,0,0),this.stopVideoStream(),this.picture=this.$refs.canvas.toDataURL(),this.showVideo=!1},upload:function(e){var t=this,n=new FileReader;n.onload=function(e){return t.picture=e.target.result},n.readAsDataURL(e.target.files[0])},done:function(){this.$emit(te.ON_DONE,this.picture)},cancel:function(){this.showVideo=!0,this.streamUserMediaVideo(),this.$emit(te.ON_CLEAR)},stopVideoStream:function(){this.$refs.player&&this.$refs.player.srcObject&&this.$refs.player.srcObject.getVideoTracks().forEach(function(e){e.stop()})}},destroyed:function(){this.stopVideoStream()}},re=ne,se=(n("213d"),Object(i["a"])(re,Q,ee,!1,null,"575f2c77",null));se.options.__file="PhotoCapture.vue";var ae=se.exports,ie=n("847e"),oe=n.n(ie),ce={data:function(){return{isCameraVisible:!1,isProcessing:!1,user:{name:"",email:"",imgData:""}}},computed:{imgData:function(){return this.user.imgData||oe.a},isValid:function(){return this.user.name&&this.user.email}},methods:{showCamera:function(){this.isCameraVisible=!0},capturePhoto:function(e){this.user.imgData=e,this.isCameraVisible=!1},register:function(){var e=Object(G["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.user.name||!this.user.email){e.next=12;break}return this.isProcessing=!0,e.prev=2,e.next=5,this.$store.dispatch({type:"register",user:this.user});case 5:this.$router.push("/"),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](2),alert("You are the problem.."),this.isProcessing=!1;case 12:case"end":return e.stop()}},e,this,[[2,8]])}));function t(){return e.apply(this,arguments)}return t}()},components:{photoCapture:ae}},ue=ce,le=(n("a894"),Object(i["a"])(ue,X,Z,!1,null,null,null));le.options.__file="Register.vue";var fe=le.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"raffle center"},[n("h2",[e._v("Raffle!")]),n("div",{staticClass:"picked",class:{final:e.isFinalPick}},[n("h1",[e._v(e._s(e.theVoterName))])]),n("button",{staticClass:"btn",on:{click:e.raffle}},[e._v("Raffle Now!")])])},pe=[],ve=n("e814"),me=n.n(ve),he={data:function(){return{theVoterName:"",isRaffleRunning:!1,isFinalPick:!1}},computed:{voterNames:function(){return this.$store.getters.shuffeledVoterNames}},methods:{raffle:function(){var e=this;if(!this.isRaffleRunning){this.isFinalPick=!1;var t,n=100,r=function r(){e.pickOne(),e.isRaffleRunning&&(t=setTimeout(r,n))};this.isRaffleRunning=!0,r();var s=setInterval(function(){n=me()(1.2*n),n>1e3&&(e.isRaffleRunning=!1,clearInterval(s),clearTimeout(t),e.isFinalPick=!0)},1e3)}},pickOne:function(){var e=this.$store.getters.shuffeledVoterNames,t=me()(Math.random()*e.length);this.theVoterName=e[t]}}},ge=he,be=(n("5d01"),Object(i["a"])(ge,de,pe,!1,null,null,null));be.options.__file="Raffle.vue";var _e=be.exports;r["a"].use(l["a"]);var Ce=new l["a"]({mode:"hash",base:"/serverless-example/",routes:[{path:"/",name:"home",component:J},{path:"/register",name:"register",component:fe},{path:"/raffle",name:"raffle",component:_e}]}),we=(n("55dd"),n("2f62")),ye="daahi2yaz",ke="ezwfqugs",xe="https://api.cloudinary.com/v1_1/".concat(ye,"/image/upload"),Ve=function(e){var t=new FormData;return t.append("file",e),t.append("upload_preset",ke),fetch(xe,{method:"POST",body:t}).then(function(e){return e.json()}).then(function(e){var t=e.url;return{url:t}}).catch(function(e){return console.error(e)})},Oe={upload:Ve};r["a"].use(we["a"]);var je=new we["a"].Store({state:{user:null,votes:[]},mutations:{setVotes:function(e,t){e.votes=t},setUser:function(e,t){e.user=t}},actions:{vote:function(){var e=Object(G["a"])(regeneratorRuntime.mark(function e(t,n){var r,s,a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,s=t.state,a=n.candidate,i=s.user,i.voteForCandidate=a,e.next=6,K.add("vote",i);case 6:r("setUser",i);case 7:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),register:function(){var e=Object(G["a"])(regeneratorRuntime.mark(function e(t,n){var r,s,a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.commit,s=n.user,a={email:s.email,name:s.name,imgUrl:"",voteForCandidate:null},r("setUser",a),!s.imgData){e.next=10;break}return e.next=7,Oe.upload(s.imgData);case 7:i=e.sent,a.imgUrl=i.url,r("setUser",a);case 10:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},getters:{votes:function(e){return e.votes},isAdmin:function(e){return e.user&&"admin"===e.user.name&&"admin@misterbit.co.il"===e.user.email},candidates:function(e){return e.votes.reduce(function(e,t){return e[t.voteForCandidate]||(e[t.voteForCandidate]=0),e[t.voteForCandidate]++,e},{})},voters:function(e){return e.votes.reduce(function(e,t){return e[t.name]||(e[t.name]={votesCount:0,imgUrl:t.imgUrl}),e[t.name].votesCount++,e},{})},shuffeledVoterNames:function(e,t){var n=function(e){return e.sort(function(){return Math.random()-.5})};return n(h()(t.voters))}}}),Re=function(e){je.commit("setVotes",e||[])};K.subscribe("vote",Re);var $e=je,Ne=n("9483");console.log("process.env.BASE_URL:::","/serverless-example/"),Object(Ne["a"])("".concat("/serverless-example/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n("34ef"),n("a481"),n("14b9");var Pe=n("bc3a"),Ue=n.n(Pe),De={mail:"mailto:someemail@email.com",publicKey:"BLc-s9wisrfhmLNoVKa3mqvsv7VxNZU5qFYmR3Wy-1noDQLUlaXwISm5xNx3JvHhUFjGL_sYl8DpKbRl6mZdq1M",privateKey:"XK - MitZjyumXV9Nc9uvKzi29cYYHOz7VVi1ywqTj_lE"},Ee="https://serverless-example-952af.firebaseio.com";function Se(){var e;"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){return e=t,t.pushManager.getSubscription()}).then(function(t){if(!t){var n=De.publicKey,r=Ae(n);return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r})}}).then(function(e){if(e)return Ue.a.post("".concat(Ee,"/subscriptions.json"),e)}).then(function(e){e&&e.ok&&console.log("subscription added successfully")}).catch(function(e){console.log(e)})}function Ae(e){for(var t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),s=new Uint8Array(r.length),a=0;a<r.length;++a)s[a]=r.charCodeAt(a);return s}"Notification"in window&&(console.log("Notification is supported!"),Notification.requestPermission(function(e){console.log("notifications permisstions: ",e),"denied"!==e?Se():console.log("notifications permisstions denied!")}));n("a0d8");r["a"].config.productionTip=!1,new r["a"]({router:Ce,store:$e,render:function(e){return e(u)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var r=n("5e27"),s=n.n(r);s.a},"5d01":function(e,t,n){"use strict";var r=n("4601"),s=n.n(r);s.a},"5e27":function(e,t,n){},"847e":function(e,t,n){e.exports=n.p+"img/anonymous.736c8b5c.png"},"8f12":function(e,t,n){},a0d8:function(e,t,n){},a894:function(e,t,n){"use strict";var r=n("4c48"),s=n.n(r);s.a},a93e:function(e,t,n){"use strict";var r=n("8f12"),s=n.n(r);s.a},dace:function(e,t,n){e.exports=n.p+"img/candidate1.da268b5f.jpg"},fd04:function(e,t,n){e.exports=n.p+"img/candidate2.184091bf.jpg"}});
//# sourceMappingURL=app.a95fc6bb.js.map